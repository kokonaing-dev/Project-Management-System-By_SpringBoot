<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title> Board </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description"/>
    <meta content="Coderthemes" name="author"/>

    <!-- App favicon -->
    <link rel="shortcut icon" href="/images/favicon.ico">


    <!-- Daterangepicker css -->
    <link rel="stylesheet" href="/libs/daterangepicker/daterangepicker.css">

    <!-- Vector Map css -->
    <link rel="stylesheet" href="/libs/admin-resources/jquery.vectormap/jquery-jvectormap-1.2.2.css">

    <!-- Theme Config Js -->
    <script src="/js/config.js"></script>

    <!-- App css -->
    <link href="/css/app.min.css" rel="stylesheet" type="text/css" id="app-style"/>

    <!-- Icons css -->
    <link href="/css/icons.min.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.1.0/remixicon.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.1.0/remixicon.min.css">

    <!-- Dragula CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.10.5/sweetalert2.css"
          integrity="sha512-n1PBkhxQLVIma0hnm731gu/40gByOeBjlm5Z/PgwNxhJnyW1wYG8v7gPJDT6jpk0cMHfL8vUGUVjz3t4gXyZYQ=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
          integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <!-- Dragula JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.js"></script>


    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <!-- Icons css -->
    <link href="/css/icons.min.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.1.0/remixicon.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.1.0/remixicon.min.css">


</head>
<body>
<!-- Begin page -->
<div class="wrapper">

    <div th:insert="~{/top-bar :: top-bar}"></div>
    <!-- ========== Topbar End ========== -->

    <!-- ========== Left Sidebar Start ========== -->
    <div th:insert="~{/leftside-menu :: leftside-menu}"></div>
    <!-- ========== Left Sidebar End ========== -->

    <!-- ============================================================== -->
    <!-- Start Page Content here -->
    <!-- ============================================================== -->

    <div class="content-page">
        <div class="content">

            <!-- Start Content-->
            <div class="container-fluid">

                <!-- Hidden input field for ROLE_SYSTEM_ADMIN -->
                <!--                <input type="hidden" id="roleSystemAdmin" th:if="${loggedInUser != null && #authorization.expression('hasRole(''ROLE_SYSTEM_ADMIN'')')}" th:value="ROLE_SYSTEM_ADMIN">-->

                <div class="modal fade" id="projectModal" tabindex="-1" role="dialog"
                     aria-labelledby="NewTaskModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" style="max-width: 1000px;">
                        <div class="modal-content" style="background-color:#eeeef1;color: black;">
                            <div class="modal-header" style="padding: 20px 30px;">
                                <h4 class="modal-title">Select a Project</h4>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                            </div>
                            <div class="modal-body" style="height: 300px; padding: 0 30px;">
                                <form class="p-2" enctype="multipart/form-data" id="projectForm" th:object="${project}">
                                    <select class="js-example-basic-single form-control" id="projectSelect"
                                            th:field="*{projectName}">
                                        <option value="" id="defaultOption">Select Project</option>
                                        <option th:each="project : ${projectList}" th:value="${project.id}"
                                                th:text="${project.projectName}"></option>
                                    </select>
                                </form>
                            </div>
                        </div><!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                </div><!-- /.modal -->


                <!-- Include jQuery library -->
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
                <script>
                    $(document).ready(function () {
                        $('.js-example-basic-single').select2();
                    });
                </script>
                <script>
                    $(document).ready(function () {
                        // Hide the default option when the document is ready
                        $('#defaultOption').hide();

                        // Variable to store selected project ID
                        var projectId; // Rename the variable to projectId

                        // When an option is selected
                        $('#projectSelect').on('change', function () {
                            // Get the selected project name and ID
                            var selectedProjectName = $(this).find(':selected').text();
                            var selectedProjectId = $(this).val();

                            // Populate users based on the selected project
                            populateUsers(selectedProjectId);

                            console.log("IDDDDDDDDDD" + selectedProjectId);

                            // Set the selected project name as the title of the next modal
                            $('#add-new-task-modal .modal-title').text(selectedProjectName);

                            // Set the project ID in the hidden input field
                            $('#projectId').val(selectedProjectId);

                            // Close current modal
                            $('#projectModal').modal('hide');

                            // Open next modal
                            $('#add-new-task-modal').modal('show');

                            // Prevent the default option from being shown again
                            $('#defaultOption').hide();
                        });

                        // Function to populate users based on selected project ID
                        function populateUsers(selectedProjectId) {
                            // Make AJAX request to fetch users for the selected project
                            $.ajax({
                                url: '/user/fetch_users', // URL to the controller endpoint for fetching users
                                method: 'GET',
                                data: {projectId: selectedProjectId}, // Pass the project ID
                                success: function (response) {
                                    // Clear existing options
                                    $('#userSelect').empty();
                                    // Add default option
                                    $('#userSelect').append('<option value="" disabled>Select User</option>');

                                    // Check if the response is an array or a single object
                                    if (Array.isArray(response)) {
                                        // If it's an array, iterate over it and add options
                                        response.forEach(function (user) {
                                            $('#userSelect').append('<option value="' + user.id + '">' + user.username + '</option>');
                                        });
                                    } else if (response.id !== undefined) {
                                        // If it's a single object, wrap it inside an array and add the option
                                        $('#userSelect').append('<option value="' + response.id + '">' + response.username + '</option>');
                                    } else {
                                        console.error('Invalid response format:', response);
                                    }
                                }
                                ,
                                error: function (xhr, status, error) {
                                    console.error('Failed to fetch users:', error);
                                    // Show error message using SweetAlert
                                    Swal.fire({
                                        title: 'Error!',
                                        text: 'Failed to fetch users. Please try again later.',
                                        icon: 'error',
                                        confirmButtonText: 'OK'
                                    });
                                }
                            });
                        }

                    });
                </script>


                <!-- Include jQuery -->
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
                <!-- Include Bootstrap JS -->
                <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
                <!-- Include Select2 JS -->
                <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-rc.0/js/select2.min.js"></script>
                <!-- Initialize Select2 -->


                <div class="row">
                    <div class="col-12">
                        <div class="page-title-box justify-content-between d-flex align-items-lg-center flex-lg-row flex-column">
                            <!-- Check if the logged-in user has ROLE_MEMBER authority -->

                            <h4 class="page-title">Board
                                <a th:unless="${#authorization.expression('hasAuthority(''ROLE_MEMBER'')')}" href="#"
                                   data-bs-toggle="modal" data-bs-target="#projectModal"
                                   class="btn btn-success btn-sm ms-3">
                                    <i class="ri-add-circle-fill"></i>
                                    Add New Issue</a>
                            </h4>

                            <ol class="breadcrumb m-0">
                                <li class="breadcrumb-item"><a href="/dashboard">Home</a></li>
                                <li class="breadcrumb-item active">Board</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 mb-2">
                        <label for="search-select"></label>
                        <select id="search-select" class="form-control" data-control="select2"
                                data-placeholder="Select an option">
                            <option th:each="type : ${issueTypes}" th:value="${type.id}"
                                    th:text="${type.issueName}"></option>
                        </select>
                    </div>

                    <div class="col-2 mb-2">
                        <label for="search-select"></label>
                        <select id="search-status" class="form-control" data-control="select2"
                                data-placeholder="Select an option">
                            <option th:each="issueStatus : ${issueStatuses}" th:value="${issueStatus}"
                                    th:text="${issueStatus}"></option>
                        </select>
                    </div>

                    <div class="col-2 mb-2">
                        <label for="search-select"></label>
                        <select id="search-category" class="form-control" data-placeholder="Select an option">
                            <option th:each="category : ${categories}" th:value="${category.id}"
                                    th:text="${category.categoryName}"></option>
                        </select>
                    </div>

                    <div class="col-2 mb-2">
                        <label for="search-select"></label>
                        <select id="search-project" class="form-control" data-placeholder="Select an option">
                            <option th:each="project : ${projectList}" th:value="${project.id}"
                                    th:text="${project.projectName}"></option>
                        </select>
                    </div>
                </div>

                <script>
                    // Get the select element for issue types
                    var selectElementIssueType = document.getElementById('search-select');

                    // Add event listener for change event for issue types
                    selectElementIssueType.addEventListener('change', function () {
                        // Get the selected option
                        var selectedOption = selectElementIssueType.options[selectElementIssueType.selectedIndex];

                        // Get the text of the selected option (issueName)
                        var selectedIssueName = selectedOption.text;

                        // Print or do whatever you want with the selected issueName
                        console.log(selectedIssueName);

                        // Iterate over each board
                        var boards = document.querySelectorAll('.board');
                        boards.forEach(function (board) {
                            // Iterate over each task list within the current board
                            var taskLists = board.querySelectorAll('.task-list-items');
                            taskLists.forEach(function (taskList) {
                                // Find issues within the current task list
                                var issues = taskList.querySelectorAll('.card');
                                issues.forEach(function (issue) {
                                    // Access issue details
                                    var issueTypeElement = issue.querySelector('.issue-type');

                                    // Check if issueTypeElement is not null before accessing its textContent
                                    if (issueTypeElement) {
                                        var issueType = issueTypeElement.textContent;

                                        // Set display property based on whether issue matches the selected option
                                        if (issueType === selectedIssueName) {
                                            issue.style.display = ''; // Show issue
                                        } else {
                                            issue.style.display = 'none'; // Hide issue
                                        }
                                    } else {
                                        // Handle cases where the issue type element is not found
                                        console.log('Issue type element not found for issue:', issue);
                                    }
                                });
                            });
                        });
                    });
                </script>


                <script>
                    // Get the select element for issue statuses
                    var selectElementIssueStatus = document.getElementById('search-status');

                    // Add event listener for change event for issue statuses
                    selectElementIssueStatus.addEventListener('change', function () {
                        // Get the selected option
                        var selectedOption = selectElementIssueStatus.options[selectElementIssueStatus.selectedIndex];

                        // Get the text of the selected option (issueName)
                        var selectedIssueStatus = selectedOption.text;

                        // Print or do whatever you want with the selected issueName
                        console.log(selectedIssueStatus);

                        // Initialize counter for found elements
                        var foundCount = 0;

                        // Iterate over each board
                        var boards = document.querySelectorAll('.board');
                        boards.forEach(function (board) {
                            // Iterate over each task list within the current board
                            var taskLists = board.querySelectorAll('.task-list-items');
                            taskLists.forEach(function (taskList) {
                                // Find issues within the current task list
                                var issues = taskList.querySelectorAll('.card');
                                issues.forEach(function (issue) {
                                    // Access issue details
                                    var issueStatusElement = issue.querySelector('.issue-status');

                                    // Check if issueTypeElement is not null before accessing its textContent
                                    if (issueStatusElement) {
                                        var issueStatus = issueStatusElement.textContent;

                                        // Set display property based on whether issue matches the selected option
                                        if (issueStatus === selectedIssueStatus) {
                                            issue.style.display = ''; // Show issue
                                            foundCount++; // Increment found element counter
                                        } else {
                                            issue.style.display = 'none'; // Hide issue
                                        }
                                    } else {
                                        // Handle cases where the issue type element is not found
                                        console.log('Issue Status element not found for issue:', issue);
                                    }
                                });
                            });
                        });

                        // Output found count
                        console.log("Found elements: " + foundCount);

                        // Update count in the HTML
                        var countElement = document.querySelector('.task-header span');
                        if (countElement) {
                            countElement.textContent = foundCount;
                        }
                    });
                </script>


                <script>
                    // Get the select element for issue statuses
                    var selectElementIssueCategory = document.getElementById('search-category');

                    // Add event listener for change event for issue statuses
                    selectElementIssueCategory.addEventListener('change', function () {
                        // Get the selected option
                        var selectedOption = selectElementIssueCategory.options[selectElementIssueCategory.selectedIndex];

                        // Get the text of the selected option (issueName)
                        var selectedIssueCategory = selectedOption.text;

                        // Print or do whatever you want with the selected issueName
                        console.log(selectedIssueCategory);

                        // Iterate over each board
                        var boards = document.querySelectorAll('.board');
                        boards.forEach(function (board) {
                            // Iterate over each task list within the current board
                            var taskLists = board.querySelectorAll('.task-list-items');
                            taskLists.forEach(function (taskList) {
                                // Find issues within the current task list
                                var issues = taskList.querySelectorAll('.card');
                                issues.forEach(function (issue) {
                                    // Access issue details
                                    var issueCategoryElement = issue.querySelector('.issue-category');

                                    // Check if issueTypeElement is not null before accessing its textContent
                                    if (issueCategoryElement) {
                                        var issueCategory = issueCategoryElement.textContent;

                                        // Set display property based on whether issue matches the selected option
                                        if (issueCategory === selectedIssueCategory) {
                                            issue.style.display = ''; // Show issue
                                        } else {
                                            issue.style.display = 'none'; // Hide issue
                                        }
                                    } else {
                                        // Handle cases where the issue type element is not found
                                        console.log('Issue Category element not found for issue:', issue);
                                    }
                                });
                            });
                        });
                    });
                </script>

                <script>
                    // Get the select element for issue statuses
                    var selectElementIssueProject = document.getElementById('search-project');

                    // Add event listener for change event for issue statuses
                    selectElementIssueProject.addEventListener('change', function () {
                        // Get the selected option
                        var selectedOption = selectElementIssueProject.options[selectElementIssueProject.selectedIndex];

                        // Get the text of the selected option (issueName)
                        var selectedIssueProject = selectedOption.text;

                        // Print or do whatever you want with the selected issueName
                        console.log(selectedIssueProject);

                        // Iterate over each board
                        var boards = document.querySelectorAll('.board');
                        boards.forEach(function (board) {
                            // Iterate over each task list within the current board
                            var taskLists = board.querySelectorAll('.task-list-items');
                            taskLists.forEach(function (taskList) {
                                // Find issues within the current task list
                                var issues = taskList.querySelectorAll('.card');
                                issues.forEach(function (issue) {
                                    // Access issue details
                                    var issueProjectElement = issue.querySelector('.issue-project');

                                    // Check if issueTypeElement is not null before accessing its textContent
                                    if (issueProjectElement) {
                                        var issueProject = issueProjectElement.textContent;

                                        // Set display property based on whether issue matches the selected option
                                        if (issueProject === selectedIssueProject) {
                                            issue.style.display = ''; // Show issue
                                        } else {
                                            issue.style.display = 'none'; // Hide issue
                                        }
                                    } else {
                                        // Handle cases where the issue type element is not found
                                        console.log('Issue Category element not found for issue:', issue);
                                    }
                                });
                            });
                        });
                    });
                </script>


                <div class="row">
                    <div class="col-12">
                        <div class="board">
                            <div class="tasks" data-plugin="dragula"
                                 data-containers='["task-list-one", "task-list-two", "task-list-three", "task-list-four", "task-list-five" ]'>
                                <h5 class="mt-0 task-header">OPEN (<span th:text="${todoIssues.size()}"></span>)</h5>

                                <div id="task-list-one" class="task-list-items">

                                    <!-- Task Item -->
                                    <div class="card mb-0" th:each="issue : ${todoIssues}" th:id="${issue.id}">
                                        <div class="card-body p-3">
                                            <span class="float-end badge bg-warning-subtle text-warning"
                                                  th:text="${issue.priority}"></span>
                                            <span class="issue-status float-end badge bg-danger-subtle text-success"
                                                  th:text="${issue.issueStatus}"></span>
                                            <span class="issue-type" th:text="${issue.issueType.issueName}"></span>
                                            <span class="issue-category" th:text="${issue.category.categoryName}"
                                                  style="display: none;"></span>
                                            <small>Created</small>
                                            <small class="text-muted" th:text="${issue.createdAt}"></small>

                                            <h5 class="my-2 fs-16">
                                                <a href="#" th:id="'moreInfo_' + ${issue.id}" class="more-info"
                                                   th:data-issue-id="${issue.id}" th:text="${issue.subject}">
                                                </a>
                                            </h5>

                                            <p class="mb-0">
                                                        <span class="pe-2 text-nowrap mb-2 d-inline-block">
                                                            <i class="ri-briefcase-5-fill"></i>
                                                            <span class="issue-project"
                                                                  th:text="${issue.project.projectName}">
                                                            </span>

                                                        </span>
                                                <span class="text-nowrap mb-2 d-inline-block">
                                                            <small style="color: red;"
                                                                   th:text="${issue.planDueDate}"></small>
                                                            <img src="/hot-icon.svg" style="width: 20px; height: 20px;"
                                                                 alt="SVG Photo">
                                                        </span>
                                            </p>

                                            <div class="dropdown float-end mt-2"
                                                 th:if="${not #authorization.expression('hasAuthority(''ROLE_MEMBER'')')}">
                                                <a href="#" class="dropdown-toggle text-muted arrow-none"
                                                   data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="ri-more-2-fill fs-18"></i>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-animated dropdown-menu-end">
                                                    <!-- item-->
                                                    <a th:href="@{'issue/editissue/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item edit-issue-link" data-bs-toggle="modal"
                                                       data-bs-target="#add-new-task-modal" data-action="edit"><i
                                                            class="ri-edit-box-line me-1"></i>Edit</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/deleteissue/' + ${issue.id}}"
                                                       th:id="${issue.id}" onclick="showConfirmation(event)"
                                                       class="dropdown-item"><i class="ri-delete-bin-line me-1"></i>Delete</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/addpeople/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item add-people-link" data-bs-toggle="modal"
                                                       data-bs-target="#addPeopleModal"><i
                                                            class="ri-user-add-line me-1"></i>Add People</a>
                                                </div>
                                            </div>


                                            <div class="avatar-group mt-2">
                                                <!-- Iterate over each user associated with the issue, limiting to three users -->
                                                <th:block th:each="user, iterStat : ${issue.users}"
                                                          th:if="${iterStat.index < 3}">
                                                    <a href="javascript:void(0);"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top"
                                                       th:title="${user.username}" th:data-issue-id="${issue.id}">
                                                        <img th:if="${user.photosImagePath != null}"
                                                             th:src="${user.photosImagePath}" alt=""
                                                             class="rounded-circle avatar-xs">
                                                        <div th:unless="${user.photosImagePath != null}"
                                                             class="avatar-xs">
                                                            <div class="avatar-title rounded-circle text-bg-success">
                                                                <th:block
                                                                        th:text="${user.username.substring(0,1)}"></th:block>
                                                                <!-- Display first letter of the name -->
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>


                                                <!-- Display a '+' sign if there are more than three users -->
                                                <th:block th:if="${issue.users.size() > 3}">
                                                    <a href="#" th:id="'moreInfo_' + ${issue.id}"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top" title="More +"
                                                       th:data-issue-id="${issue.id}">
                                                        <div class="avatar-xs">
                                                            <div class="avatar-title rounded-circle">
                                                                <th:block
                                                                        th:text="${issue.users.size() - 3}"></th:block>
                                                                +
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>
                                            </div>

                                        </div> <!-- end card-body -->
                                    </div>
                                    <!-- Task Item End -->
                                </div> <!-- end company-list-1-->
                            </div>

                            <div class="modal fade" id="issueModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                                 aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h1 class="modal-title fs-5" id="exampleModalLabel">Issue Details</h1>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <!-- Issue information will be populated here -->
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                                Close
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                                 aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h1 class="modal-title fs-5" id="userModalLabel">User Details</h1>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <!-- User information will be displayed here -->
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                                Close
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <script th:inline="javascript">
                                $(document).ready(function () {
                                    $('.more-info').click(function (e) {
                                        e.preventDefault();
                                        var issueId = $(this).data('issue-id');
                                        console.log("Issue Fetch...." + issueId);
                                        $.ajax({
                                            url: '/getIssueInfo', // URL to fetch issue information
                                            type: 'GET',
                                            data: {issueId: issueId},
                                            success: function (response) {
                                                $('#issueModal .modal-body').html(response);
                                                $('#issueModal').modal('show');
                                            },
                                            error: function () {
                                                alert('Error fetching issue information');
                                            }
                                        });
                                    });
                                });
                            </script>

                            <script th:inline="javascript">
                                $(document).ready(function () {
                                    $('.more-userInfo, .avatar-group-item').click(function (e) {
                                        e.preventDefault();
                                        var issueId = $(this).data('issue-id');
                                        console.log("Issue User Fetch...." + issueId);
                                        $.ajax({
                                            url: '/getIssueUserInfo', // URL to fetch issue user information
                                            type: 'GET',
                                            data: {issueId: issueId},
                                            success: function (response) {
                                                $('#userModal .modal-body').html(response);
                                                $('#userModal').modal('show');
                                            },
                                            error: function () {
                                                alert('Error fetching issue user information');
                                            }
                                        });
                                    });
                                });
                            </script>


                            <div class="modal fade" id="addPeopleModal" tabindex="-1"
                                 aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h1 class="modal-title fs-5" id="addPeopleModalLabel">Add People</h1>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                        </div>
                                        <form id="addPeopleForm" enctype="multipart/form-data">
                                            <div class="modal-body">

                                                <div class="mb-3">
                                                    <label for="userSelect" class="form-label">Select Users</label>
                                                    <select class="form-select" id="projectUserSelect"
                                                            name="selectedUsers" multiple>
                                                        <!-- Users will be populated dynamically using JavaScript -->
                                                    </select>
                                                </div>

                                            </div>
                                            <div class="modal-footer">
                                                <button type="reset" class="btn btn-secondary" data-bs-dismiss="modal">
                                                    Close
                                                </button>
                                                <button type="submit" class="btn btn-primary">Add</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>


                            <div class="tasks">
                                <h5 class="mt-0 task-header text-uppercase">In Progress (<span
                                        th:text="${inProgressIssues.size()}"></span>)</h5>

                                <div id="task-list-two" class="task-list-items">

                                    <!-- Task Item -->
                                    <div class="card mb-0" th:each="issue : ${inProgressIssues}" th:id="${issue.id}">
                                        <div class="card-body p-3">
                                            <span class="float-end badge bg-danger-subtle text-danger"
                                                  th:text="${issue.priority}"></span>
                                            <span class="issue-status float-end badge bg-danger-subtle text-success"
                                                  th:text="${issue.issueStatus}"></span>
                                            <span class="issue-type" th:text="${issue.issueType.issueName}"></span>
                                            <span class="issue-category" th:text="${issue.category.categoryName}"
                                                  style="display: none;"></span>
                                            <small>Created</small>
                                            <small class="text-muted" th:text="${issue.createdAt}"></small>

                                            <h5 class="my-2 fs-16">
                                                <a href="#" th:id="'moreInfo_' + ${issue.id}" class="more-info"
                                                   th:data-issue-id="${issue.id}" th:text="${issue.subject}">
                                                </a>
                                            </h5>

                                            <p class="mb-0">
                                                        <span class="pe-2 text-nowrap mb-2 d-inline-block">
                                                            <i class="ri-briefcase-5-fill"></i>
                                                            <span class="issue-project"
                                                                  th:text="${issue.project.projectName}">
                                                            </span>
                                                        </span>
                                                <span class="text-nowrap mb-2 d-inline-block">
                                                            <small style="color: red;"
                                                                   th:text="${issue.planDueDate}"></small>
                                                            <img src="/hot-icon.svg" style="width: 20px; height: 20px;"
                                                                 alt="SVG Photo">
                                                        </span>
                                            </p>

                                            <div class="dropdown float-end mt-2"
                                                 th:if="${not #authorization.expression('hasAuthority(''ROLE_MEMBER'')')}">
                                                <a href="#" class="dropdown-toggle text-muted arrow-none"
                                                   data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="ri-more-2-fill fs-18"></i>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-animated dropdown-menu-end">
                                                    <!-- item-->
                                                    <a th:href="@{'issue/editissue/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item edit-issue-link" data-bs-toggle="modal"
                                                       data-bs-target="#add-new-task-modal" data-action="edit"><i
                                                            class="ri-edit-box-line me-1"></i>Edit</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/deleteissue/' + ${issue.id}}"
                                                       th:id="${issue.id}" onclick="showConfirmation(event)"
                                                       class="dropdown-item"><i class="ri-delete-bin-line me-1"></i>Delete</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/addpeople/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item add-people-link" data-bs-toggle="modal"
                                                       data-bs-target="#addPeopleModal"><i
                                                            class="ri-user-add-line me-1"></i>Add People</a>
                                                </div>
                                            </div>


                                            <div class="avatar-group mt-2">
                                                <!-- Iterate over each user associated with the issue, limiting to three users -->
                                                <th:block th:each="user, iterStat : ${issue.users}"
                                                          th:if="${iterStat.index < 3}">
                                                    <a href="javascript:void(0);"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top"
                                                       th:title="${user.username}" th:data-issue-id="${issue.id}">
                                                        <img th:if="${user.photosImagePath != null}"
                                                             th:src="${user.photosImagePath}" alt=""
                                                             class="rounded-circle avatar-xs">
                                                        <div th:unless="${user.photosImagePath != null}"
                                                             class="avatar-xs">
                                                            <div class="avatar-title rounded-circle text-bg-success">
                                                                <th:block
                                                                        th:text="${user.username.substring(0,1)}"></th:block>
                                                                <!-- Display first letter of the name -->
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>


                                                <!-- Display a '+' sign if there are more than three users -->
                                                <th:block th:if="${issue.users.size() > 3}">
                                                    <a href="#" th:id="'moreInfo_' + ${issue.id}"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top" title="More +"
                                                       th:data-issue-id="${issue.id}">
                                                        <div class="avatar-xs">
                                                            <div class="avatar-title rounded-circle">
                                                                <th:block
                                                                        th:text="${issue.users.size() - 3}"></th:block>
                                                                +
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>
                                            </div>
                                        </div> <!-- end card-body -->
                                    </div>
                                    <!-- Task Item End -->


                                </div> <!-- end company-list-2-->
                            </div>


                            <div class="tasks">
                                <h5 class="mt-0 task-header text-uppercase">SOLVED (<span
                                        th:text="${solvedIssues.size()}"></span>)</h5>
                                <div id="task-list-three" class="task-list-items">

                                    <!-- Task Item -->
                                    <div class="card mb-0" th:each="issue : ${solvedIssues}" th:id="${issue.id}">
                                        <div class="card-body p-3">
                                            <span class="float-end badge bg-danger-subtle text-danger"
                                                  th:text="${issue.priority}"></span>
                                            <span class="issue-status float-end badge bg-danger-subtle text-success"
                                                  th:text="${issue.issueStatus}"></span>
                                            <span class="issue-type" th:text="${issue.issueType.issueName}"></span>
                                            <span class="issue-category" th:text="${issue.category.categoryName}"
                                                  style="display: none;"></span>
                                            <small>Created</small>
                                            <small class="text-muted" th:text="${issue.createdAt}"></small>

                                            <h5 class="my-2 fs-16">
                                                <a href="#" th:id="'moreInfo_' + ${issue.id}" class="more-info"
                                                   th:data-issue-id="${issue.id}" th:text="${issue.subject}">
                                                </a>
                                            </h5>

                                            <p class="mb-0">
                                                        <span class="pe-2 text-nowrap mb-2 d-inline-block">
                                                            <i class="ri-briefcase-5-fill"></i>
                                                            <span class="issue-project"
                                                                  th:text="${issue.project.projectName}">
                                                            </span>
                                                        </span>
                                                <span class="text-nowrap mb-2 d-inline-block">
                                                            <small style="color: red;"
                                                                   th:text="${issue.planDueDate}"></small>
                                                            <img src="/hot-icon.svg" style="width: 20px; height: 20px;"
                                                                 alt="SVG Photo">
                                                        </span>
                                            </p>

                                            <div class="dropdown float-end mt-2"
                                                 th:if="${not #authorization.expression('hasAuthority(''ROLE_MEMBER'')')}">
                                                <a href="#" class="dropdown-toggle text-muted arrow-none"
                                                   data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="ri-more-2-fill fs-18"></i>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-animated dropdown-menu-end">
                                                    <!-- item-->
                                                    <a th:href="@{'issue/editissue/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item edit-issue-link" data-bs-toggle="modal"
                                                       data-bs-target="#add-new-task-modal" data-action="edit"><i
                                                            class="ri-edit-box-line me-1"></i>Edit</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/deleteissue/' + ${issue.id}}"
                                                       th:id="${issue.id}" onclick="showConfirmation(event)"
                                                       class="dropdown-item"><i class="ri-delete-bin-line me-1"></i>Delete</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/addpeople/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item add-people-link" data-bs-toggle="modal"
                                                       data-bs-target="#addPeopleModal"><i
                                                            class="ri-user-add-line me-1"></i>Add People</a>
                                                </div>
                                            </div>


                                            <div class="avatar-group mt-2">
                                                <!-- Iterate over each user associated with the issue, limiting to three users -->
                                                <th:block th:each="user, iterStat : ${issue.users}"
                                                          th:if="${iterStat.index < 3}">
                                                    <a href="javascript:void(0);"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top"
                                                       th:title="${user.username}" th:data-issue-id="${issue.id}">
                                                        <img th:if="${user.photosImagePath != null}"
                                                             th:src="${user.photosImagePath}" alt=""
                                                             class="rounded-circle avatar-xs">
                                                        <div th:unless="${user.photosImagePath != null}"
                                                             class="avatar-xs">
                                                            <div class="avatar-title rounded-circle text-bg-success">
                                                                <th:block
                                                                        th:text="${user.username.substring(0,1)}"></th:block>
                                                                <!-- Display first letter of the name -->
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>


                                                <!-- Display a '+' sign if there are more than three users -->
                                                <th:block th:if="${issue.users.size() > 3}">
                                                    <a href="#" th:id="'moreInfo_' + ${issue.id}"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top" title="More +"
                                                       th:data-issue-id="${issue.id}">
                                                        <div class="avatar-xs">
                                                            <div class="avatar-title rounded-circle">
                                                                <th:block
                                                                        th:text="${issue.users.size() - 3}"></th:block>
                                                                +
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>
                                            </div>
                                        </div> <!-- end card-body -->
                                    </div>
                                    <!-- Task Item End -->


                                </div> <!-- end company-list-3-->
                            </div>

                            <div class="tasks">
                                <h5 class="mt-0 task-header text-uppercase">PENDING (<span
                                        th:text="${pendingIssues.size()}"></span>)</h5>
                                <div id="task-list-four" class="task-list-items">

                                    <!-- Task Item -->
                                    <div class="card mb-0" th:each="issue : ${pendingIssues}" th:id="${issue.id}">
                                        <div class="card-body p-3">
                                            <span class="float-end badge bg-danger-subtle text-danger"
                                                  th:text="${issue.priority}"></span>
                                            <span class="issue-status float-end badge bg-danger-subtle text-success"
                                                  th:text="${issue.issueStatus}"></span>
                                            <span class="issue-type" th:text="${issue.issueType.issueName}"></span>
                                            <span class="issue-category" th:text="${issue.category.categoryName}"
                                                  style="display: none;"></span>
                                            <small>Created</small>
                                            <small class="text-muted" th:text="${issue.createdAt}"></small>

                                            <h5 class="my-2 fs-16">
                                                <a href="#" th:id="'moreInfo_' + ${issue.id}" class="more-info"
                                                   th:data-issue-id="${issue.id}" th:text="${issue.subject}">
                                                </a>
                                            </h5>

                                            <p class="mb-0">
                                                        <span class="pe-2 text-nowrap mb-2 d-inline-block">
                                                            <i class="ri-briefcase-5-fill"></i>
                                                            <span class="issue-project"
                                                                  th:text="${issue.project.projectName}">
                                                            </span>
                                                        </span>
                                                <span class="text-nowrap mb-2 d-inline-block">
                                                            <small style="color: red;"
                                                                   th:text="${issue.planDueDate}"></small>
                                                            <img src="/hot-icon.svg" style="width: 20px; height: 20px;"
                                                                 alt="SVG Photo">
                                                        </span>
                                            </p>

                                            <div class="dropdown float-end mt-2"
                                                 th:if="${not #authorization.expression('hasAuthority(''ROLE_MEMBER'')')}">
                                                <a href="#" class="dropdown-toggle text-muted arrow-none"
                                                   data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="ri-more-2-fill fs-18"></i>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-animated dropdown-menu-end">
                                                    <!-- item-->
                                                    <a th:href="@{'issue/editissue/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item edit-issue-link" data-bs-toggle="modal"
                                                       data-bs-target="#add-new-task-modal" data-action="edit"><i
                                                            class="ri-edit-box-line me-1"></i>Edit</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/deleteissue/' + ${issue.id}}"
                                                       th:id="${issue.id}" onclick="showConfirmation(event)"
                                                       class="dropdown-item"><i class="ri-delete-bin-line me-1"></i>Delete</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/addpeople/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item add-people-link" data-bs-toggle="modal"
                                                       data-bs-target="#addPeopleModal"><i
                                                            class="ri-user-add-line me-1"></i>Add People</a>
                                                </div>
                                            </div>


                                            <div class="avatar-group mt-2">
                                                <!-- Iterate over each user associated with the issue, limiting to three users -->
                                                <th:block th:each="user, iterStat : ${issue.users}"
                                                          th:if="${iterStat.index < 3}">
                                                    <a href="javascript:void(0);"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top"
                                                       th:title="${user.username}" th:data-issue-id="${issue.id}">
                                                        <img th:if="${user.photosImagePath != null}"
                                                             th:src="${user.photosImagePath}" alt=""
                                                             class="rounded-circle avatar-xs">
                                                        <div th:unless="${user.photosImagePath != null}"
                                                             class="avatar-xs">
                                                            <div class="avatar-title rounded-circle text-bg-success">
                                                                <th:block
                                                                        th:text="${user.username.substring(0,1)}"></th:block>
                                                                <!-- Display first letter of the name -->
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>


                                                <!-- Display a '+' sign if there are more than three users -->
                                                <th:block th:if="${issue.users.size() > 3}">
                                                    <a href="#" th:id="'moreInfo_' + ${issue.id}"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top" title="More +"
                                                       th:data-issue-id="${issue.id}">
                                                        <div class="avatar-xs">
                                                            <div class="avatar-title rounded-circle">
                                                                <th:block
                                                                        th:text="${issue.users.size() - 3}"></th:block>
                                                                +
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>
                                            </div>
                                        </div> <!-- end card-body -->
                                    </div>
                                    <!-- Task Item End -->

                                </div> <!-- end company-list-4-->
                            </div>


                            <div class="tasks">
                                <h5 class="mt-0 task-header text-uppercase">CLOSED (<span
                                        th:text="${closedIssues.size()}"></span>)</h5>
                                <div id="task-list-five" class="task-list-items">

                                    <!-- Task Item -->
                                    <div class="card mb-0" th:each="issue : ${closedIssues}" th:id="${issue.id}">
                                        <div class="card-body p-3">
                                            <span class="float-end badge bg-danger-subtle text-danger"
                                                  th:text="${issue.priority}"></span>
                                            <span class="issue-status float-end badge bg-danger-subtle text-success"
                                                  th:text="${issue.issueStatus}"></span>
                                            <span class="issue-type" th:text="${issue.issueType.issueName}"></span>
                                            <span class="issue-category" th:text="${issue.category.categoryName}"
                                                  style="display: none;"></span>
                                            <small>Created</small>
                                            <small class="text-muted" th:text="${issue.createdAt}"></small>

                                            <h5 class="my-2 fs-16">
                                                <a href="#" th:id="'moreInfo_' + ${issue.id}" class="more-info"
                                                   th:data-issue-id="${issue.id}" th:text="${issue.subject}">
                                                </a>
                                            </h5>

                                            <p class="mb-0">
                                                        <span class="pe-2 text-nowrap mb-2 d-inline-block">
                                                            <i class="ri-briefcase-5-fill"></i>
                                                            <span class="issue-project"
                                                                  th:text="${issue.project.projectName}">
                                                            </span>
                                                        </span>
                                                <span class="text-nowrap mb-2 d-inline-block">
                                                            <small style="color: red;"
                                                                   th:text="${issue.planDueDate}"></small>
                                                            <img src="/hot-icon.svg" style="width: 20px; height: 20px;"
                                                                 alt="SVG Photo">
                                                        </span>
                                            </p>

                                            <div class="dropdown float-end mt-2"
                                                 th:if="${not #authorization.expression('hasAuthority(''ROLE_MEMBER'')')}">
                                                <a href="#" class="dropdown-toggle text-muted arrow-none"
                                                   data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="ri-more-2-fill fs-18"></i>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-animated dropdown-menu-end">
                                                    <!-- item-->
                                                    <a th:href="@{'issue/editissue/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item edit-issue-link" data-bs-toggle="modal"
                                                       data-bs-target="#add-new-task-modal" data-action="edit"><i
                                                            class="ri-edit-box-line me-1"></i>Edit</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/deleteissue/' + ${issue.id}}"
                                                       th:id="${issue.id}" onclick="showConfirmation(event)"
                                                       class="dropdown-item"><i class="ri-delete-bin-line me-1"></i>Delete</a>
                                                    <!-- item-->
                                                    <a th:href="@{'issue/addpeople/' + ${issue.id}}" th:id="${issue.id}"
                                                       class="dropdown-item add-people-link" data-bs-toggle="modal"
                                                       data-bs-target="#addPeopleModal"><i
                                                            class="ri-user-add-line me-1"></i>Add People</a>
                                                </div>
                                            </div>


                                            <div class="avatar-group mt-2">
                                                <!-- Iterate over each user associated with the issue, limiting to three users -->
                                                <th:block th:each="user, iterStat : ${issue.users}"
                                                          th:if="${iterStat.index < 3}">
                                                    <a href="javascript:void(0);"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top"
                                                       th:title="${user.username}" th:data-issue-id="${issue.id}">
                                                        <img th:if="${user.photosImagePath != null}"
                                                             th:src="${user.photosImagePath}" alt=""
                                                             class="rounded-circle avatar-xs">
                                                        <div th:unless="${user.photosImagePath != null}"
                                                             class="avatar-xs">
                                                            <div class="avatar-title rounded-circle text-bg-success">
                                                                <th:block
                                                                        th:text="${user.username.substring(0,1)}"></th:block>
                                                                <!-- Display first letter of the name -->
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>


                                                <!-- Display a '+' sign if there are more than three users -->
                                                <th:block th:if="${issue.users.size() > 3}">
                                                    <a href="#" th:id="'moreInfo_' + ${issue.id}"
                                                       class="avatar-group-item more-userInfo"
                                                       data-bs-toggle="tooltip" data-bs-placement="top" title="More +"
                                                       th:data-issue-id="${issue.id}">
                                                        <div class="avatar-xs">
                                                            <div class="avatar-title rounded-circle">
                                                                <th:block
                                                                        th:text="${issue.users.size() - 3}"></th:block>
                                                                +
                                                            </div>
                                                        </div>
                                                    </a>
                                                </th:block>
                                            </div>
                                        </div> <!-- end card-body -->
                                    </div>
                                    <!-- Task Item End -->

                                </div> <!-- end company-list-4-->
                            </div>

                        </div> <!-- end .board-->
                    </div> <!-- end col -->
                </div>
                <!-- end row-->

            </div> <!-- container -->

        </div> <!-- content -->

        <!-- Footer Start -->
        <footer class="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-6">
                        <script>document.write(new Date().getFullYear())</script>
                        © PMS - G-3
                    </div>
                    <div class="col-md-6">
                        <div class="text-md-end footer-links d-none d-md-block">
                            <a href="javascript: void(0);">About</a>
                            <a href="javascript: void(0);">Support</a>
                            <a href="javascript: void(0);">Contact Us</a>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- end Footer -->

    </div>

    <!-- ============================================================== -->
    <!-- End Page content -->
    <!-- ============================================================== -->

</div>
<!-- END wrapper -->


<!-- Theme Settings -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="theme-settings-offcanvas">
    <div class="d-flex align-items-center bg-primary p-3 offcanvas-header">
        <h5 class="text-white m-0">Theme Settings</h5>
        <button type="button" class="btn-close btn-close-white ms-auto" data-bs-dismiss="offcanvas"
                aria-label="Close"></button>
    </div>

    <div class="offcanvas-body p-0">
        <div data-simplebar class="h-100">
            <div class="card mb-0 p-3">
                <div class="alert alert-warning" role="alert">
                    <strong>Customize </strong> the overall color scheme, sidebar menu, etc.
                </div>

                <h5 class="mt-0 fs-16 fw-bold mb-3">Choose Layout</h5>
                <div class="d-flex flex-column gap-2">
                    <div class="form-check form-switch">
                        <input id="customizer-layout01" name="data-layout" type="checkbox" value="vertical"
                               class="form-check-input">
                        <label class="form-check-label" for="customizer-layout01">Vertical</label>
                    </div>
                    <div class="form-check form-switch">
                        <input id="customizer-layout02" name="data-layout" type="checkbox" value="horizontal"
                               class="form-check-input">
                        <label class="form-check-label" for="customizer-layout02">Horizontal</label>
                    </div>
                </div>

                <h5 class="my-3 fs-16 fw-bold">Color Scheme</h5>

                <div class="d-flex flex-column gap-2">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" name="data-bs-theme" id="layout-color-light"
                               value="light">
                        <label class="form-check-label" for="layout-color-light">Light</label>
                    </div>

                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" name="data-bs-theme" id="layout-color-dark"
                               value="dark">
                        <label class="form-check-label" for="layout-color-dark">Dark</label>
                    </div>
                </div>

                <div id="layout-width">
                    <h5 class="my-3 fs-16 fw-bold">Layout Mode</h5>

                    <div class="d-flex flex-column gap-2">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-layout-mode"
                                   id="layout-mode-fluid" value="fluid">
                            <label class="form-check-label" for="layout-mode-fluid">Fluid</label>
                        </div>

                        <div id="layout-boxed">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" name="data-layout-mode"
                                       id="layout-mode-boxed" value="boxed">
                                <label class="form-check-label" for="layout-mode-boxed">Boxed</label>
                            </div>
                        </div>

                        <div id="layout-detached">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" name="data-layout-mode"
                                       id="data-layout-detached" value="detached">
                                <label class="form-check-label" for="data-layout-detached">Detached</label>
                            </div>
                        </div>
                    </div>
                </div>

                <h5 class="my-3 fs-16 fw-bold">Topbar Color</h5>

                <div class="d-flex flex-column gap-2">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" name="data-topbar-color" id="topbar-color-light"
                               value="light">
                        <label class="form-check-label" for="topbar-color-light">Light</label>
                    </div>

                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" name="data-topbar-color" id="topbar-color-dark"
                               value="dark">
                        <label class="form-check-label" for="topbar-color-dark">Dark</label>
                    </div>

                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" name="data-topbar-color" id="topbar-color-brand"
                               value="brand">
                        <label class="form-check-label" for="topbar-color-brand">Brand</label>
                    </div>
                </div>

                <div>
                    <h5 class="my-3 fs-16 fw-bold">Menu Color</h5>

                    <div class="d-flex flex-column gap-2">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-menu-color"
                                   id="leftbar-color-light" value="light">
                            <label class="form-check-label" for="leftbar-color-light">Light</label>
                        </div>

                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-menu-color"
                                   id="leftbar-color-dark" value="dark">
                            <label class="form-check-label" for="leftbar-color-dark">Dark</label>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-menu-color"
                                   id="leftbar-color-brand" value="brand">
                            <label class="form-check-label" for="leftbar-color-brand">Brand</label>
                        </div>
                    </div>
                </div>

                <div id="sidebar-size">
                    <h5 class="my-3 fs-16 fw-bold">Sidebar Size</h5>

                    <div class="d-flex flex-column gap-2">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-sidenav-size"
                                   id="leftbar-size-default" value="default">
                            <label class="form-check-label" for="leftbar-size-default">Default</label>
                        </div>

                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-sidenav-size"
                                   id="leftbar-size-compact" value="compact">
                            <label class="form-check-label" for="leftbar-size-compact">Compact</label>
                        </div>

                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-sidenav-size"
                                   id="leftbar-size-small" value="condensed">
                            <label class="form-check-label" for="leftbar-size-small">Condensed</label>
                        </div>

                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-sidenav-size"
                                   id="leftbar-size-small-hover" value="sm-hover">
                            <label class="form-check-label" for="leftbar-size-small-hover">Hover View</label>
                        </div>

                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-sidenav-size"
                                   id="leftbar-size-full" value="full">
                            <label class="form-check-label" for="leftbar-size-full">Full Layout</label>
                        </div>

                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" name="data-sidenav-size"
                                   id="leftbar-size-fullscreen" value="fullscreen">
                            <label class="form-check-label" for="leftbar-size-fullscreen">Fullscreen Layout</label>
                        </div>
                    </div>
                </div>

                <div id="layout-position">
                    <h5 class="my-3 fs-16 fw-bold">Layout Position</h5>

                    <div class="btn-group checkbox" role="group">
                        <input type="radio" class="btn-check" name="data-layout-position" id="layout-position-fixed"
                               value="fixed">
                        <label class="btn btn-soft-primary w-sm" for="layout-position-fixed">Fixed</label>

                        <input type="radio" class="btn-check" name="data-layout-position"
                               id="layout-position-scrollable" value="scrollable">
                        <label class="btn btn-soft-primary w-sm ms-0"
                               for="layout-position-scrollable">Scrollable</label>
                    </div>
                </div>

                <div id="sidebar-user">
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <label class="fs-16 fw-bold m-0" for="sidebaruser-check">Sidebar User Info</label>
                        <div class="form-check form-switch">
                            <input type="checkbox" class="form-check-input" name="sidebar-user" id="sidebaruser-check">
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
    <div class="offcanvas-footer border-top p-3 text-center">
        <div class="row">
            <div class="col-6">
                <button type="button" class="btn btn-light w-100" id="reset-layout">Reset</button>
            </div>
            <div class="col-6">
                <a href="#" role="button" class="btn btn-primary w-100">Buy Now</a>
            </div>
        </div>
    </div>
</div>

<!--  Add new task modal -->
<div class="modal fade task-modal-content" id="add-new-task-modal" tabindex="-1" role="dialog"
     aria-labelledby="NewTaskModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" style="max-width: 1070px;">
        <div class="modal-content">
            <div class="modal-header" style="background-color:#007bff; color: #fff; padding: 20px 30px;">
                <h4 class="modal-title" id="NewTaskModalLabel">Create New Task</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style="background-color:#eeeef1;color: black; padding: 0 30px;">
                <form class="p-2" id="issueForm" th:object="${issue}" enctype="multipart/form-data">

                    <input type="hidden" id="projectId" name="projectId">

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">IssueType</label>
                                <select id="issueType" class="form-select" th:field="*{issueType}">
                                    <option th:each="issueType : ${issueTypes}" th:value="${issueType.id}"
                                            th:text="${issueType.issueName}"></option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Category</label>
                                <select id="category" class="form-select" th:field="*{category}">
                                    <option th:each="category : ${categories}" th:value="${category.id}"
                                            th:text="${category.categoryName}"></option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="subject" class="form-label">Subject</label>
                        <span id="subjectError" class="text-danger"></span>
                        <input type="text" class="form-control" id="subject" th:field="*{subject}"
                               placeholder="Subject">
                    </div>

                    <div class="mb-3">
                        <label for="task-description" class="form-label">Description</label>
                        <textarea class="form-control" id="task-description" rows="3"></textarea>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Priority</label>
                                <select class="form-select" th:field="*{priority}">
                                    <option th:each="priority : ${priorities}" th:value="${priority}"
                                            th:text="${priority}"></option>
                                </select>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="attachments" class="form-label">Attachments</label>
                                <input type="file" class="form-control" id="attachments" name="attachments" multiple>
                            </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="planStartDate" class="form-label">Plan Start Date</label>
                                <!-- Error div -->
                                <span id="errorDiv" class="text-danger"></span>
                                <span id="dateError" class="text-danger"></span>
                                <input type="date" class="form-control" id="planStartDate" th:field="*{planStartDate}">
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="planDueDate" class="form-label">Plan Due Date</label>
                                <input type="date" class="form-control" id="planDueDate" th:field="*{planDueDate}">
                            </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="mb-3 edit">
                            <label class="form-label">Assign To</label>
                            <!-- Add this dropdown for selecting users -->
                            <select id="userSelect" class="form-control" multiple="multiple" th:field="*{users}"
                                    required>
                                <!-- Default option -->
                                <!-- Options will be dynamically populated -->
                            </select>
                        </div>
                    </div>

                    <div class="text-end">
                        <button type="reset" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" id="createIssueBtn" class="btn btn-primary">Create</button>
                    </div>
                </form>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<script th:if="${#authorization.expression('hasAuthority(''ROLE_MEMBER'')')}">
    document.addEventListener('DOMContentLoaded', function () {
        // Get all task containers
        const taskContainers = document.querySelectorAll('.task-list-items');

        // Initialize Dragula for all task containers
        const drake = dragula(Array.from(taskContainers), {
            // Add your options here if needed
        });

        // Add event listener for when an item is dropped
        drake.on('drop', function (el, target, source, sibling) {
            // Get the source and target task lists
            const sourceTaskList = source.id;
            const targetTaskList = target.id;

            // Check if the drag and drop operation is allowed based on the user's role
            if (isMemberRestricted(sourceTaskList, targetTaskList)) {
                // Disallow drop for the forbidden transition
                drake.cancel(true);
                return;
            }

            // Your existing code for handling drop event
            // Get the dragged issue ID
            const draggedIssueId = el.getAttribute('id');
            console.log("Dragged Issue ID: " + draggedIssueId);

            // Get the new issueStatus based on the target task list
            let newIssueStatus;
            switch (targetTaskList) {
                case 'task-list-one':
                    newIssueStatus = 'OPEN';
                    break;
                case 'task-list-two':
                    newIssueStatus = 'IN_PROGRESS';
                    break;
                case 'task-list-three':
                    newIssueStatus = 'SOLVED';
                    break;
                case 'task-list-four':
                    newIssueStatus = 'PENDING';
                    break;
                case 'task-list-five':
                    newIssueStatus = 'CLOSED';
                    break;
                default:
                    break;
            }

            // Perform a fetch request to update the issueStatus
            fetch('/updateIssueStatus', {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    issueId: draggedIssueId,
                    newIssueStatus: newIssueStatus
                })
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to update issue status');
                    }
                    console.log('Issue status updated successfully');

                    // Update the issue status in the DOM
                    const statusElement = el.querySelector('.float-end.badge.bg-danger-subtle.text-success');
                    if (statusElement) {
                        statusElement.textContent = newIssueStatus;
                        console.log('Issue status updated in the DOM');
                        // Auto-reload the page after updating status
                        // setTimeout(() => {
                        //     window.location.reload();
                        // }, 2000); // Reload after 2 seconds (adjust the time as needed)
                    } else {
                        console.error('Status element not found in the dragged issue');
                    }
                })
                .catch(error => {
                    console.error('Error updating issue status:', error);
                });
            // Update issue counts after drop
            updateIssueCounts();
        });

        function updateIssueCounts() {
            // Iterate over task containers to update issue counts
            taskContainers.forEach(container => {
                const countElement = container.previousElementSibling.querySelector('span');
                if (countElement) {
                    const issueCount = container.querySelectorAll('.card').length;
                    countElement.textContent = issueCount;
                }
            });
        }

        // Function to check if the drag and drop operation is allowed for ROLE_MEMBER
        function isMemberRestricted(source, target) {
            // Define the restricted transitions
            const restrictedTransitionsForMember = [
                {source: 'task-list-one', target: 'task-list-five'}, // OPEN to CLOSED
                {source: 'task-list-two', target: 'task-list-five'}, // IN_PROGRESS to CLOSED
                {source: 'task-list-three', target: 'task-list-five'}, // SOLVED to CLOSED
                {source: 'task-list-four', target: 'task-list-five'}, // PENDING to CLOSED
                {source: 'task-list-five', target: 'task-list-four'},  // CLOSED to PENDING
                {source: 'task-list-five', target: 'task-list-three'},  // CLOSED to SOLVED
                {source: 'task-list-five', target: 'task-list-two'},  // CLOSED to IN_PROGRESS
                {source: 'task-list-five', target: 'task-list-one'}  // CLOSED to OPEN
            ];

            // Check if the current source and target match any restricted transition
            return restrictedTransitionsForMember.some(transition => transition.source === source && transition.target === target);
        }
    });
</script>


<script th:unless="${#authorization.expression('hasAuthority(''ROLE_MEMBER'')')}">
    document.addEventListener('DOMContentLoaded', function () {
        // Get all task containers
        const taskContainers = document.querySelectorAll('.task-list-items');

        // Initialize Dragula for all task containers
        const drake = dragula(Array.from(taskContainers), {
            // Add your options here if needed
        });

        // Add event listener for when an item is dropped
        drake.on('drop', function (el, target, source, sibling) {
            // Get the dragged issue ID
            const draggedIssueId = el.getAttribute('id');
            console.log("Dragged Issue ID: " + draggedIssueId);

            // Get the target task list
            const targetTaskList = target.id;
            console.log("Target Task List: " + targetTaskList);

            // Define the new issueStatus based on the target task list
            let newIssueStatus;
            switch (targetTaskList) {
                case 'task-list-one':
                    newIssueStatus = 'OPEN';
                    break;
                case 'task-list-two':
                    newIssueStatus = 'IN_PROGRESS';
                    break;
                case 'task-list-three':
                    newIssueStatus = 'SOLVED';
                    break;
                case 'task-list-four':
                    newIssueStatus = 'PENDING';
                    break;
                case 'task-list-five':
                    newIssueStatus = 'CLOSED';
                    break;
                default:
                    break;
            }

            // Perform a fetch request to update the issueStatus
            fetch('/updateIssueStatus', {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    issueId: draggedIssueId,
                    newIssueStatus: newIssueStatus
                })
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to update issue status');
                    }
                    console.log('Issue status updated successfully');

                    // Update the issue status in the DOM
                    const statusElement = el.querySelector('.float-end.badge.bg-danger-subtle.text-success');
                    if (statusElement) {
                        statusElement.textContent = newIssueStatus;
                        console.log('Issue status updated in the DOM');
                        // Auto-reload the page after updating status
                        // setTimeout(() => {
                        //     window.location.reload();
                        // }, 2000); // Reload after 2 seconds (adjust the time as needed)
                    } else {
                        console.error('Status element not found in the dragged issue');
                    }
                })
                .catch(error => {
                    console.error('Error updating issue status:', error);
                });
            // Update issue counts after drop
            updateIssueCounts();
        });

        function updateIssueCounts() {
            // Iterate over task containers to update issue counts
            taskContainers.forEach(container => {
                const countElement = container.previousElementSibling.querySelector('span');
                if (countElement) {
                    const issueCount = container.querySelectorAll('.card').length;
                    countElement.textContent = issueCount;
                }
            });
        }
    });
</script>


<script>
    $(document).ready(function () {
        var isEditing = false;
        var issueId; // Declare issueId in a broader scope
        $('.edit-issue-link').click(function (e) {
            e.preventDefault();
            issueId = $(this).attr('id');
            fetchIssueDetails(issueId);
            isEditing = true; // Set editing mode to true
            $('#userSelect').removeAttr('required'); // Remove 'required' attribute
        });

        function fetchIssueDetails(issueId) {
            $.ajax({
                url: '/api/issue/' + issueId,
                method: 'GET',
                success: function (response) {
                    populateModal(response);
                },
                error: function (xhr, status, error) {
                    console.error(error);
                }
            });
        }

        function populateModal(issue) {
            $('#issueForm').attr('action', '/issue/edit/' + issue.id);
            $('#NewTaskModalLabel').text('Edit Task');
            $('#createIssueBtn').text('Save Changes');


            $('#subject').val(issue.subject);
            $('#task-description').val(issue.description);
            $('#priority').val(issue.priority);
            $('#planStartDate').val(issue.planStartDate);
            $('#planDueDate').val(issue.planDueDate);

            // Populate category
            $('#category').val(issue.category.id);


            if (isEditing) {
                // Hide the div containing the select element when editing
                $('.mb-3.edit').hide();
            } else {
                // Show the div when not editing
                $('.mb-3.edit').show();
                location.reload();
            }

            // Populate other fields similarly
        }

        // Function to handle form submission
        $('#issueForm').submit(function (e) {
            e.preventDefault(); // Prevent the default form submission

            if (!isEditing) {
                // If not in editing mode, proceed with form submission for adding issue
                createIssue();
            } else {
                // If in editing mode, make a PATCH request to update the issue
                updateIssue(issueId); // Pass the stored issueId for updating
            }
        });

        // Function to update existing issue
        function updateIssue(issueId) {
            // Serialize the form data to JSON
            var formData = {
                // issueType: {
                //     id: $('#issueType').val(),  // Assuming this is the issueType ID
                //     issueName: $('#issueType option:selected').text()  // Assuming this is the issueType name
                // },
                subject: $('#subject').val(),
                description: $('#task-description').val(),
                priority: $('#priority').val(),
                planStartDate: $('#planStartDate').val(),
                planDueDate: $('#planDueDate').val(),
                category: {
                    id: $('#category').val(),
                    categoryName: $('#category option:selected').text()
                }
            };

            console.log("Issue Id" + issueId);

            var jsonData = JSON.stringify(formData);
            console.log(jsonData);

            $.ajax({
                url: '/issue/edit/' + issueId,
                method: 'PATCH',
                data: jsonData,
                contentType: 'application/json',
                success: function (response) {
                    Swal.fire({
                        title: 'Success!',
                        text: 'Issue updated successfully!',
                        icon: 'success',
                        showConfirmButton: true
                    }).then(() => {
                        location.reload();
                    });
                },
                error: function (xhr, status, error) {
                    console.error('Failed to update issue:', error);
                    // Handle error
                }
            });
        }


        // Function to create new issue
        function createIssue() {
            // Here you can access the project ID from the hidden input field
            var projectId = $('#projectId').val();
            console.log("Project ID " + projectId);

            // Get plan start and due dates
            var planStartDate = new Date($('#planStartDate').val());
            var planDueDate = new Date($('#planDueDate').val());

            console.log(planStartDate);
            console.log(planDueDate);

            // Check conditions
            if (planStartDate > planDueDate) {
                // Display error message for plan start date > plan due date
                $('#errorDiv').text('**Plan start date cannot be greater than plan due date');
                return;
            } else {
                // Clear any previous error messages
                $('#errorDiv').text('');
            }

            // Create a new FormData object
            var formData = new FormData(document.getElementById('issueForm'));

            // Append attachments to FormData
            // var files = $('#attachments')[0].files;
            // console.log(files);
            // for (var i = 0; i < files.length; i++) {
            //     formData.append('attachments', files[i]);
            // }

            // Append form fields to FormData
            formData.append('issueType', $('#issueType').val());
            formData.append('description', $('#task-description').val());

            // Append select field values to FormData
            formData.append('priority', $('#priority').val());
            formData.append('category', $('#category').val());

            formData.append('planStartDate', $('#planStartDate').val());
            formData.append('planDueDate', $('#planDueDate').val());

            // Add selected user IDs to form data
            const selectedUsers = document.getElementById('userSelect').selectedOptions;
            const userIds = Array.from(selectedUsers).map(option => option.value);
            formData.append('userIds', userIds.join(','));
            console.log("USER IDs " + userIds)

            // Make AJAX request to save the issue
            $.ajax({
                url: '/issue/process_issue', // URL to the controller endpoint for saving issues
                method: 'POST', // HTTP method
                data: formData, // Form data
                contentType: false, // Set to false when using FormData
                processData: false, // Set to false when using FormData
                success: function (response) {
                    // Handle success response
                    console.log('Issue created successfully:', response);
                    // Close the modal
                    $('#add-new-task-modal').modal('hide');
                    // Show success message using SweetAlert
                    Swal.fire({
                        title: 'Success!',
                        text: 'Issue created successfully.',
                        icon: 'success',
                        confirmButtonText: 'OK'
                    });
                },
                error: function (xhr, status, error) {
                    if (xhr.status === 400) {
                        // Extract the error message from xhr.responseText
                        var errorMessage = xhr.responseText;
                        // Set the error message content with the link
                        $('#subjectError').html(errorMessage);
                    } else {
                        // Show a generic error message if the error status is not 400
                        Swal.fire({
                            title: 'Error!',
                            text: 'Failed to create issue. Please try again later.',
                            icon: 'error',
                            confirmButtonText: 'OK'
                        });
                    }
                }
            });
        }

    });
</script>


<script>
    $(document).ready(function () {
        var issueId; // Declare issueId in a higher scope

        $('.add-people-link').click(function (e) {
            e.preventDefault();
            issueId = $(this).attr('id');

            // AJAX request to fetch users associated with the selected issue
            $.ajax({
                type: 'GET',
                url: '/api/users/' + issueId, // Replace with your actual endpoint
                success: function (data) {
                    // Clear existing options
                    $('#projectUserSelect').empty();

                    // Populate select dropdown with retrieved user data
                    $.each(data, function (index, user) {
                        $('#projectUserSelect').append($('<option>', {
                            value: user.id,
                            text: user.username // Replace 'name' with the actual property containing user's name
                        }));
                    });

                    // Show the modal
                    $('#addPeopleModal').modal('show');
                },
                error: function (xhr, status, error) {
                    console.error(xhr.responseText);
                    // Handle error
                }
            });
        });

        // Submit the form when the "Add" button is clicked
        $('#addPeopleForm').submit(function (e) {
            e.preventDefault();

            console.log("Issue Id... " + issueId);

            // Get selected user IDs
            var selectedUsers = $('#projectUserSelect').val();
            console.log(selectedUsers);

            // AJAX request to add users to the project
            $.ajax({
                type: 'POST',
                url: '/api/user_issue/add',
                contentType: 'application/json',
                data: JSON.stringify({issueId: issueId, selectedUsers: selectedUsers}), // Include issueId
                success: function (response) {
                    // Handle success response
                    console.log(response);

                    Swal.fire({
                        title: 'Success!',
                        text: 'New Member added successfully.',
                        icon: 'success',
                        confirmButtonText: 'OK'
                    });

                    // Close the modal
                    $('#addPeopleModal').modal('hide');
                },
                error: function (xhr, status, error) {
                    console.error(xhr.responseText);
                    // Handle error
                }
            });
        });
    });
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.10.5/sweetalert2.min.js"
        integrity="sha512-WHVh4oxWZQOEVkGECWGFO41WavMMW5vNCi55lyuzDBID+dHg2PIxVufsguM7nfTYN3CEeQ/6NB46FWemzpoI6Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    function showConfirmation(event) {
        event.preventDefault(); // Prevent the default action of the link

        // Use SweetAlert to show a confirmation dialog
        Swal.fire({
            title: 'Are you sure?',
            text: 'You will not be able to recover this issue!',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'Cancel'
        }).then((result) => {
            if (result.isConfirmed) {
                // If confirmed, call the deleteIssue function with the issue ID
                deleteIssue(event.target.getAttribute('id'));
            }
        });
    }

    function deleteIssue(id) {
        fetch(`/issue/deleteissue/${id}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                // Display success message using SweetAlert
                Swal.fire({
                    title: 'Success!',
                    text: data.message, // Access the message property of data
                    icon: 'success',
                    // timer: 3000,
                    // timerProgressBar: true,
                    showConfirmButton: true
                })
            })
            .catch(error => {
                console.error('Error:', error);
                // Handle error if necessary
            });
    }
</script>


<!-- Vendor js -->
<script src="/js/vendor.min.js"></script>

<!-- dragula js-->
<script src="/libs/dragula/dragula.min.js"></script>

<!-- demo js -->
<script src="/js/pages/component.dragula.js"></script>

<!-- App js -->
<script src="/js/app.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script src="/js/socket.js"></script>

</body>

</html>
